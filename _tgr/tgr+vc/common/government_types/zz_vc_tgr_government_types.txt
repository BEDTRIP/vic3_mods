# VC + TGR compatch â€” government type merges
# Goal: keep VC's extra restrictions, but use TGR's law variant checks and safety exclusions.

REPLACE_OR_CREATE:gov_presidential_democracy = {
	transfer_of_power = presidential_elective
	new_leader_on_reform_government = no

	male_ruler = "RULER_TITLE_PRESIDENT"
	female_ruler = "RULER_TITLE_PRESIDENT"

	possible = {
		has_law_or_variant = law_type:law_presidential_republic
		NOT = { country_has_primary_culture = cu:yankee }
		NOR = {
			AND = {
				exists = c:GBR
				is_subject_of = c:GBR
				c:GBR = { has_law_or_variant = law_type:law_monarchy }
			}
			AND = {
				exists = c:IMP
				is_subject_of = c:IMP
				c:IMP = { has_law_or_variant = law_type:law_monarchy }
			}
		}
		country_has_voting_franchise = yes
		NOR = {
			has_law_or_variant = law_type:law_single_party_state
			has_law_or_variant = law_type:law_technocracy
			AND = {
				country_has_primary_culture = cu:brazilian
				has_law_or_variant = law_type:law_presidential_republic
				has_law_or_variant = law_type:law_landed_voting
				OR = {
					has_law_or_variant = law_type:law_tenant_farmers
					has_law_or_variant = law_type:law_serfdom
				}
			}
		}
		NOT = { has_journal_entry = je_peru_bolivia } # TGR safety
	}

	on_government_type_change = {
		change_to_presidential_elective = yes
	}
	on_post_government_type_change = {
		post_change_to_presidential_elective = yes
	}
}

REPLACE_OR_CREATE:gov_presidential_dictatorship = {
	transfer_of_power = dictatorial

	male_ruler = "RULER_TITLE_PRESIDENT"
	female_ruler = "RULER_TITLE_PRESIDENT"

	possible = {
		has_law_or_variant = law_type:law_presidential_republic
		has_law_or_variant = law_type:law_autocracy
		country_has_voting_franchise = no
		OR = {
			has_law_or_variant = law_type:law_peasant_levies
			has_law_or_variant = law_type:law_national_militia
			ig:ig_armed_forces ?= {
				is_in_government = no
			}
		}
		NOT = {
			OR = {
				AND = {
					exists = c:GBR
					is_subject_of = c:GBR
					c:GBR ?= { has_law_or_variant = law_type:law_monarchy }
				}
				AND = {
					exists = c:IMP
					is_subject_of = c:IMP
					c:IMP ?= { has_law_or_variant = law_type:law_monarchy }
				}
			}
		}
		NOT = { has_journal_entry = je_peru_bolivia } # TGR safety
	}

	on_government_type_change = {
		change_to_dictatorial = yes
	}
	on_post_government_type_change = {
		post_change_to_dictatorial = yes
	}
}

